<rec-header></rec-header>

<main>
  <div class="container">
    <h3>Estás armando un recuerdo relacionado a FAMILIA</h3>
    <h4>Selecciona las fotografías que deseas agregar</h4>
  </div>
  <hr>
  <a ng-click="pics.goBack();" ng-if="pics.status.is_sub_folder" class="btn btn-save-fix btn-simple btn-default btn-block btn-sm">../</a>
  <table class="table table-striped table-hover table-files">
    <thead>
      <tr>
        <th>Tipo de archivo</th>
        <th>Nombre</th>
      </tr>
    </thead>
    <tbody>
      <tr class="loading">
        <td ng-if="pics.status.loading" colSpan="2">
          <span class="glyphicon glyphicon-refresh glyphicon-refresh-animate"></span>
        </td>
      </tr>
      <tr ng-if="!pics.status.is_sub_folder" class="{{dir.action}} {{dir.type}}" ng-repeat="dir in pics.dirList" ng-click="pics.openOrAdd(dir);">
        <td>
          <span ng-class="{'glyphicon glyphicon-folder-close':dir.type=='folder','glyphicon glyphicon-file':dir.type=='file'}"></span></td>
        <td>{{dir.path}}</td>
      </tr>
      <tr ng-if="pics.status.is_sub_folder" class="{{dir.action}} {{dir.type}}" ng-repeat="dir in pics.openedDir" ng-click="pics.openOrAdd(dir);">
        <td>
          <span ng-class="{'glyphicon glyphicon-folder-close':dir.type=='folder','glyphicon glyphicon-file':dir.type=='file'}"></span>
        </td>
        <td>{{dir.path}}</td>
      </tr>
    </tbody>
  </table>

  <div class="container pics">

    <div ng-repeat="dir in pics.openedDir" ng-if="$index % 6 == 0" class="row">
        <div ng-click="pics.openOrAdd(pics.openedDir[$index]);" class="col-xs-2 pic-thumb text-center {{pics.openedDir[$index].action}} {{pics.openedDir[$index].type}}">
          <img ng-click="pics.openOrAdd(pics.openedDir[$index]);" ng-src="{{pics.openedDir[$index].thumbnailUrl}}" alt="{{pics.openedDir[$index].path}}" class="img-rounded">
        </div>
        <div ng-if="pics.openedDir[$index + 1].thumbnailUrl" ng-click="pics.openOrAdd(pics.openedDir[$index + 1]);" class="col-xs-2 pic-thumb text-center {{pics.openedDir[$index + 1].action}} {{pics.openedDir[$index + 1].type}}">
          <img ng-if="pics.openedDir[$index + 1].thumbnailUrl" ng-src="{{pics.openedDir[$index + 1].thumbnailUrl}}" alt="{{pics.openedDir[$index + 1].path}}" class="img-rounded">
        </div>
        <div ng-if="pics.openedDir[$index + 2].thumbnailUrl" ng-click="pics.openOrAdd(pics.openedDir[$index + 2]);" class="col-xs-2 pic-thumb text-center {{pics.openedDir[$index + 2].action}} {{pics.openedDir[$index + 2].type}}">
          <img ng-if="pics.openedDir[$index + 2].thumbnailUrl" ng-src="{{pics.openedDir[$index + 2].thumbnailUrl}}" alt="{{pics.openedDir[$index + 2].path}}" class="img-rounded">
        </div>
        <div ng-if="pics.openedDir[$index + 3].thumbnailUrl" ng-click="pics.openOrAdd(pics.openedDir[$index + 3]);" class="col-xs-2 pic-thumb text-center {{pics.openedDir[$index + 3].action}} {{pics.openedDir[$index + 3].type}}">
          <img ng-if="pics.openedDir[$index + 3].thumbnailUrl" ng-src="{{pics.openedDir[$index + 3].thumbnailUrl}}" alt="{{pics.openedDir[$index + 3].path}}" class="img-rounded">
        </div>
        <div ng-if="pics.openedDir[$index + 4].thumbnailUrl" ng-click="pics.openOrAdd(pics.openedDir[$index + 4]);" class="col-xs-2 pic-thumb text-center {{pics.openedDir[$index + 4].action}} {{pics.openedDir[$index + 4].type}}">
          <img ng-if="pics.openedDir[$index + 4].thumbnailUrl" ng-src="{{pics.openedDir[$index + 4].thumbnailUrl}}" alt="{{pics.openedDir[$index + 4].path}}" class="img-rounded">
        </div>
        <div ng-if="pics.openedDir[$index + 5].thumbnailUrl" ng-click="pics.openOrAdd(pics.openedDir[$index + 5]);" class="col-xs-2 pic-thumb text-center {{pics.openedDir[$index + 5].action}} {{pics.openedDir[$index + 5].type}}">
          <img ng-click="pics.openOrAdd(pics.openedDir[$index + 5]);" ng-src="{{pics.openedDir[$index + 5].thumbnailUrl}}" alt="{{pics.openedDir[$index + 5].path}}" class="img-rounded">
        </div>
    </div>

  </div>

  <a ng-click="pics.save();" class="btn btn-save-fix btn-primary btn-block btn-lg">Guardar ({{pics.images_stats.selected}} imagenes)</a>
</main>

<div class="save-container" ng-if="pics.status.saving">
  <div class="container searching">
    <span class="glyphicon glyphicon-refresh glyphicon-refresh-animate"></span>
    <h2>{{pics.images_stats.processed}} / {{pics.images_stats.total}}</h2>
  </div>
</div>

<div class="success-container" ng-if="pics.status.success">
  <div class="container searching">
    <span class="glyphicon glyphicon-ok"></span>
    <h2>Terapia guardada con exito. Para visualizarla entra al siguiente link: </h2>
    <input type="text" ng-model="pics.status.link">
  </div>
</div>

<rec-footer></rec-footer>